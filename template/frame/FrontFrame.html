<css src="openoa:css/base.css" />
<css src="openoa:css/watertable.css" />
<lib name='jquery'/>
<div class="w_all">

<!--top-->
	<div class="w_head">
		<div class="w_head_top">
			<div class="w_head_topmenu">
				<ul>
					<li><a href="?c=org.opencomb.openoa.PersonnelManagement.Dep.DepartmentManagement">人事管理</a></li>
					<li><a href="?c=org.opencomb.openoa.ProjectManagement.Management.ProjectManagement">项目管理</a></li>
					<li><a href="#">个人办公</a></li>
					<li><a href="?c=org.opencomb.openoa.Attendance.Punch">考勤管理</a></li>
					<li><a href="#">审批流转</a></li>
					<li><a href="#">收发公文</a></li>
				</ul>
			</div>
			<!--div class="w_head_opencomb">
				<a href="#" class="frontframe-logo"></a>
			</div-->
			<div class="w_head_user">
				<if "$aId=\org\jecat\framework\auth\IdManager::singleton()->currentId()">
					<strong>Hi,</strong>
					<span class="ico_head_user">
						<select onchange="window.location.href='?c=org.opencomb.coresystem.user.SwichId&uid=' + this.options[this.selectedOption].value">
							<foreach for="\org\jecat\framework\auth\IdManager::singleton()->iterator()" item='aId'>
							<option value="{=$aId->userId()}"{= $aId===$aCurrentId? ' selected': ''}>{=$aId->displayName()}</option>
							</foreach>
						</select>
					</span>
					<if "\org\opencomb\coresystem\auth\PurviewQuery::singleton()->hasPurview($aId,\org\opencomb\coresystem\auth\Id::PLATFORM_ADMIN,'coresystem')">
						<span class="ico_head_setup">
							<a href="?c=control.panel">控制面板</a>
						</span>
					</if>
					<span class="ico_head_out"><a href="?c=logout">退出</a></span>
				<else />
					<span class="ico_head_login"><a href="?c=login">登录</a></span>
				</if>
			</div>	
		</div>
		<!--div class="w_head_logo"></div>
		<div class="w_head_menu">
			<widget id="mainMenu" type='menu' attr.showDepths="1">
			<item id="PersonnelManagement" title="人事管理" link="?c=org.opencomb.openoa.PersonnelManagement.Dep.DepartmentManagement">
				<item id="Overtime_menu" title="部门管理" controller="org.opencomb.openoa.PersonnelManagement.Dep.DepartmentManagement" />
				<item id="Position_menu" title="职位管理" controller="org.opencomb.openoa.PersonnelManagement.Position.PositionManagement" />
				<item id="Employee_menu" title="员工管理" controller="org.opencomb.openoa.PersonnelManagement.Employee.EmployeeManagement" />
				<item id="Demission_menu" title="离职管理" controller="org.opencomb.openoa.PersonnelManagement.Demission.DemissionManagement" />
				<item id="Personnel_menu" title="人事合同管理" controller="org.opencomb.openoa.PersonnelManagement.Contract.ContractManagement" />
				<item id="Personnel_menu" title="未签合同管理" controller="org.opencomb.openoa.PersonnelManagement.Contract.NoContract" />
			</item>
			<item id="ProjectManagement" title="项目管理" link="?c=org.opencomb.openoa.ProjectManagement.Management.ProjectManagement">
				<item id="ProjectManagement_menu" title="项目管理" controller="org.opencomb.openoa.ProjectManagement.Management.ProjectManagement" />
				<item id="Assign_menu" title="我分配的项目" controller="org.opencomb.openoa.ProjectManagement.Management.MyAssignmentProject" />
				<item id="Management_menu" title="我管理的项目" controller="org.opencomb.openoa.ProjectManagement.Management.MyManagementProject" />
				<item id="add_menu" title="新建项目" controller="org.opencomb.openoa.ProjectManagement.Management.AddProject" />
				<item id="type_menu" title="项目类别管理" controller="org.opencomb.openoa.ProjectManagement.Type.ProjectTypeManagement" />
				<item id="performance_menu" title="绩效统计" controller="org.opencomb.openoa.ProjectManagement.Performance.DepartmentQuery" >
					<item id="performance_menu_query" title="部门项目查询" controller="org.opencomb.openoa.ProjectManagement.Performance.DepartmentQuery" />
					<item id="performance_menu_depart" title="部门项目绩效" controller="org.opencomb.openoa.ProjectManagement.Performance.DepartmentCount" />
					<item id="performance_menu_port" title="部门本月报表" controller="org.opencomb.openoa.ProjectManagement.Performance.DepartmentCurrentQuery" />
					<item id="performance_plan" title="部门下月计划" controller="org.opencomb.openoa.ProjectManagement.Performance.DepartmentNextQuery" />
					<item id="performance_menu_person_port" title="本人本月报表" controller="org.opencomb.openoa.ProjectManagement.Performance.MyCurrentQuery" />
					<item id="performance_menu_person_plan" title="本人下月计划" controller="org.opencomb.openoa.ProjectManagement.Performance.MyNextQuery" />
				</item>	
			</item>
			<item id="inde4114x" title="个人办公" link="?c=org.opencomb.openoa.Dispatch.LargeUsers" perms.purview.name="openoa:DiaoDu">
				<item id="DiaoDuXiTong_menu" title="调度系统(B/S软件)" controller="org.opencomb.openoa.shell.WaterShell&programName=dlsong&title=调度系统" />
			</item>
			<item id="indeAtt1" title="考勤管理" link="?c=org.opencomb.openoa.Attendance.Punch" perms.purview.name="openoa:Punch">
				<item id="Punch_menu" title="打卡签到" controller="org.opencomb.openoa.Attendance.Punch" />
				<item id="Add_menu" title="考勤补录" controller="org.opencomb.openoa.Attendance.Add" />
				<item id="Detail_menu" title="考勤报表" controller="org.opencomb.openoa.Attendance.Detail" />
				<item id="Setting_menu" title="基本考勤设置" controller="org.opencomb.openoa.Attendance.Setting" />
				<item id="Holidays_menu" title="节假日设置" controller="org.opencomb.openoa.Attendance.Holidays" />
				<item id="Overtime_menu" title="加班规则" controller="org.opencomb.openoa.Attendance.Overtime" />
				<!-- <item id="Punch6_menu" title="月考设置" controller="org.opencomb.openoa.Attendance.Punch6" /> -->
				<!-- <item id="Punch7_menu" title="年假设置" controller="org.opencomb.openoa.Attendance.Punch7" /> -->
			</item>
			<item id="inde4w44x" title="审批流转" link="?c=org.opencomb.openoa.Business.ResidentWaterStatistics" perms.purview.name="PLATFORM_ADMIN">
				<item id="YingYeZongHeGuanLiXiTong_menu" title="营业综合管理系统C/S软件" controller="org.opencomb.openoa.shell.WaterShell&programName=water_1213&title=营业综合管理系统" />
			</item>
			<item id="inde4w44x3" title="收发公文" link="?c=org.opencomb.openoa.Business.ResidentWaterStatistics" perms.purview.name="PLATFORM_ADMIN">
				<item id="YingYeZongHeGuanLiXiTong_menu" title="营业综合管理系统C/S软件" controller="org.opencomb.openoa.shell.WaterShell&programName=water_1213&title=营业综合管理系统" />
			</item>
			</widget>
		</div-->
	</div>
<!--topend-->
<div class="w_body">
<!--left-->
<div class="w_leftall" >
	<div class="w_left">
		<!-- <div class="w_left_onbutton"></div> -->
		<a href="javascript:;" onclick="w_left_offbutton()" id="w_left_button" class="w_left_offbutton">&nbsp;</a>
		<widget id="mainMenu" type='menu' attr.depth="1" attr.showDepths="2" />
		<div style="clear:both"></div>
	</div>
</div>
<!--leftend-->
<!--right-->
	<div class="w_right">
		<views />
	</div>
<!--rightend--->
<!--footer-->
	<div class="clr"></div>
	<div class="w_footer">
		<p>大连开发区自来水公司 &copy; 版权所有 2012</p>
		<p>Water company of dalian economic and technological development zone All Rights Reserved.</p>
	</div>
<!--footerend-->
</div>
</div>


<script>
/**
 * 收缩按钮
 */
function w_left_offbutton(){
	
	//侧边状态
	var w_left_width = jQuery(".w_left").width();
	if(w_left_width > 0){
		jQuery("body").addClass("bodynobg");
		
		jQuery(".w_left").animate({width: '0px'}, "slow",function(){
		});
		
		//按钮缩小（需要增加滚动条然偏移量）
		var leftScroll = parseInt( jQuery(window).scrollLeft() );
		jQuery("#w_left_button").animate({left: '-'+leftScroll+'px'}, "slow" ,function(){
			//自定义事件
			jQuery(".w_left").trigger('afterSlideIn');
			jQuery("#w_left_button").removeClass("w_left_offbutton");
			jQuery("#w_left_button").addClass("w_left_onbutton");
		});
	}else{
		jQuery(".w_left").animate({width: '205px'}, "slow",function(){
			jQuery("body").removeClass("bodynobg");
		});
		jQuery("#w_left_button").animate({left: '216px'}, "slow" , function(){
			jQuery(".w_left").trigger('afterSlideOut');
			jQuery("#w_left_button").addClass("w_left_offbutton");
			jQuery("#w_left_button").removeClass("w_left_onbutton");
		});
	}
}


/**
 * 滚动事件
 */
function auto_W_left_offbutton ()
{
	//侧边状态
	var w_left_width = jQuery(".w_left").width();
	if(w_left_width > 0){
		var divLeft = 216;
	}else{
		var divLeft = 0;
	}
	var leftScroll = parseInt( jQuery(window).scrollLeft() );
	var divLeft_now = parseInt( jQuery("#w_left_button").css("left") );
	if(divLeft_now != divLeft - leftScroll){
		jQuery("#w_left_button").css("left",divLeft - leftScroll);
	}
}

jquery(function(){
	jquery('.namecard_simple_card_id_select').change(function(){
		window.location.href='?c=org.opencomb.coresystem.user.SwichId&uid=' + jquery(this).val();
	});

	auto_W_left_offbutton();
	jQuery(window).scroll(auto_W_left_offbutton);
	
	var w_bodyH = jQuery(".w_body").height();
	jQuery(".w_left").height(w_bodyH);
	
});
</script>